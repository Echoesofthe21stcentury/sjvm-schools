<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Principal Dashboard â€“ SJVM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #e6f2ff;
      padding: 40px 20px;
    }
    h1 {
      color: #003366;
      text-align: center;
    }
    .table-box {
      max-width: 900px;
      margin: 40px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #003366;
      color: white;
    }
    input {
      padding: 6px;
      border: 1px solid #aaa;
      border-radius: 4px;
    }
    button {
      padding: 6px 12px;
      margin: 2px;
      background-color: #0055aa;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button.reject {
      background-color: crimson;
    }
    .logout {
      text-align: center;
      margin-top: 30px;
    }
  </style>
</head>
<body>

<h1>ðŸŽ“ Principal Dashboard â€“ SJVM Schools</h1>

<div class="table-box">
  <h2>Pending ID Requests (Manual Entry)</h2>
  <table id="request-table">
    <tr>
      <th>Name</th>
      <th>Role</th>
      <th>Mobile</th>
      <th>Email</th>
      <th>Assign ID</th>
      <th>Password</th>
      <th>Action</th>
    </tr>
    <!-- Example Requests -->
    <tr>
      <td>Arjun R</td>
      <td>Student</td>
      <td>9876543210</td>
      <td>arjun@example.com</td>
      <td><input type="text" value="stu003" /></td>
      <td><input type="text" value="arj123" /></td>
      <td>
        <button onclick="approve(this)">Approve</button>
        <button class="reject" onclick="reject(this)">Reject</button>
      </td>
    </tr>
    <tr>
      <td>Ms. Kavya</td>
      <td>Teacher</td>
      <td>9900990099</td>
      <td>kavya@example.com</td>
      <td><input type="text" value="t002" /></td>
      <td><input type="text" value="teach2025" /></td>
      <td>
        <button onclick="approve(this)">Approve</button>
        <button class="reject" onclick="reject(this)">Reject</button>
      </td>
    </tr>
  </table>
</div>

<div class="logout">
  <button onclick="logout()">Logout</button>
</div>

<script>
  function approve(btn) {
    const row = btn.closest("tr");
    const name = row.children[0].innerText;
    const role = row.children[1].innerText;
    const id = row.children[4].children[0].value;
    const pass = row.children[5].children[0].value;

    alert(`âœ… Approved: ${name}\nRole: ${role}\nID: ${id}\nPassword: ${pass}\n\nNow add this ID/password in userlogin.html.`);

    // Save approved ID to localStorage
    let approved = JSON.parse(localStorage.getItem("approvedIDs")) || [];
    approved.push(id);
    localStorage.setItem("approvedIDs", JSON.stringify(approved));

    row.remove();
  }

  function reject(btn) {
    const row = btn.closest("tr");
    const email = row.children[3].innerText;

    let rejected = JSON.parse(localStorage.getItem("rejectedEmails")) || [];
    rejected.push(email);
    localStorage.setItem("rejectedEmails", JSON.stringify(rejected));

    row.remove();
  }

  function logout() {
    localStorage.clear();
    window.location.href = "userlogin.html";
  }

  // Access check
  const role = localStorage.getItem("role");
  if (role !== "Principal") {
    alert("Access denied. Only Principals allowed.");
    window.location.href = "userlogin.html";
  }

  // Hide rejected requests on page load
  window.onload = function () {
    let rejected = JSON.parse(localStorage.getItem("rejectedEmails")) || [];

    const rows = document.querySelectorAll("#request-table tr");
    rows.forEach((row, index) => {
      if (index === 0) return; // skip header
      const email = row.children[3].innerText;
      if (rejected.includes(email)) {
        row.remove();
      }
    });
  };
</script>

</body>
</html>
