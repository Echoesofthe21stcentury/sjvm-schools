<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SJVM Event Gallery</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
  body{background:#203a43;color:white;font-family:'Poppins',sans-serif;margin:0;padding:0;}
  h1{text-align:center;color:#ffd700;padding:1rem;}
  .gallery-container{display:flex;flex-wrap:wrap;gap:0.5rem;justify-content:center;padding:1rem;}
  .gallery-item{width:200px;height:200px;overflow:hidden;border:2px solid #ffd700;border-radius:8px;}
  .gallery-item img{width:100%;height:100%;object-fit:cover;}
  select{padding:0.5rem;margin:0.5rem;border-radius:5px;border:none;}
</style>
</head>
<body>

<h1>SJVM Event Gallery</h1>

<div style="text-align:center;">
  <label>Select Branch:</label>
  <select id="branchSelect"></select>

  <label>Select Event:</label>
  <select id="eventSelect"></select>
</div>

<div class="gallery-container" id="gallery"></div>

<script>
let eventsData = [];

// Fetch events.json
async function loadEvents(){
  try{
    const res = await fetch('events.json');
    eventsData = await res.json();
    loadBranches();
  } catch(e){
    console.error("Error loading events.json", e);
  }
}

// Load branch dropdown
function loadBranches(){
  const branchSet = new Set(eventsData.map(e=>e.school));
  const branchSelect = document.getElementById("branchSelect");
  branchSelect.innerHTML = "";
  branchSet.forEach(b=>{
    const opt = document.createElement("option");
    opt.value = b;
    opt.textContent = b;
    branchSelect.appendChild(opt);
  });
  branchSelect.addEventListener("change", updateEvents);
  updateEvents();
}

// Load events dropdown
function updateEvents(){
  const selectedBranch = document.getElementById("branchSelect").value;
  const eventSelect = document.getElementById("eventSelect");
  eventSelect.innerHTML="";
  const filtered = eventsData.filter(e=>e.school===selectedBranch);
  filtered.forEach(ev=>{
    const opt = document.createElement("option");
    opt.value = ev.id;
    opt.textContent = ev.title;
    eventSelect.appendChild(opt);
  });
  eventSelect.addEventListener("change", showGallery);
  showGallery();
}

// Show images gallery
function showGallery(){
  const selectedEventId = parseInt(document.getElementById("eventSelect").value);
  const selectedEvent = eventsData.find(e=>e.id===selectedEventId);
  const gallery = document.getElementById("gallery");
  gallery.innerHTML = "";
  selectedEvent.images.forEach(imgPath=>{
    const div = document.createElement("div");
    div.className = "gallery-item";
    const img = document.createElement("img");
    img.src = imgPath; // path from events.json
    div.appendChild(img);
    gallery.appendChild(div);
  });
}

// Initialize
loadEvents();
</script>

</body>
</html>
